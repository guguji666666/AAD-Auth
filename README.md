# Publish RDS using AAD AP(Azure AD application proxy)

The instructions below apply to the scenario where :

>RD gateway	- Not published to public network yet ( doesn't have public IP )

>External url of RD gateway - you don’t have ssl cert issued from public CA, you will use the default external url generated by AAD AP by default

>Internal url of RD gateway	- You don’t want it to be exposed to public network , external url is different from the internal one


Server required in the deployment :

>Domain controller	* 1 (Windows server 2016+)

>RD Gateway Server * 1 (Windows server 2016+)

>RD session host + broker + licensing on a single server	* 1 (Windows server 2016+)


1. Deploy three servers first.

2. Make one server domain controller first.

3. Then join the other two servers to the domain. (do not deploy RDS infrastructure in the beginning )


# P1 : Install AAD AP connector agent on RD gateway server 

Navigate to [Microsoft (msappproxy.net)](https://download.msappproxy.net/subscription/d3c8b69d-6bf7-42be-a529-3fe9c2e70c90/connector/download) and download the latest version of AAD AP connector

![image](https://user-images.githubusercontent.com/96930989/210068026-24211a12-2ae5-437a-bbdb-216fc7768174.png)


# P2 : Create a new connector group for the new AAD AP connector

Navigate to portal.azure.com and sign in with global administrator credentials

Navigate to Azure Active Directory > Application proxy

Select the server where you installed the connector 

Select the area which is close to you to reduce latency 

![image](https://user-images.githubusercontent.com/96930989/210068036-24ae26f7-e9ce-4690-b1c7-c59c80bf986f.png)

Click +Create when the settings are done


